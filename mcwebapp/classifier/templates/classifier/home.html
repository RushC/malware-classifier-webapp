<!DOCTYPE html>
<html>
    <head>
        {% load static %}
        
        <!-- Materialize Stylesheet -->
        <link href="{% static 'classifier/materialize/css/materialize.min.css' %}" rel="stylesheet" />
        
        <!-- Material Icons -->
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
        
        <!-- Page Stylesheet -->
        <link href="{% static 'classifier/css/home.css' %}" rel="stylesheet" />
        
    </head>
    
    <body>
        
        <!-- jQuery and jQuery UI -->
        <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
        
        <!-- Bez (Used for custom Cubic Bezier Easing Function) -->
        <script type="text/javascript" src="{% static 'classifier/bez/bez.min.js' %}"></script>

        <!-- Materialize -->
        <script type="text/javascript" src="{% static 'classifier/materialize/js/materialize.min.js' %}"></script>

        <!-- Page Scripts -->
        <script type="text/javascript" src="{% static 'classifier/js/uifunctions.js' %}"></script>
        <script type="text/javascript" src="{% static 'classifier/js/filebox.js' %}"></script>
        <script type="text/javascript" src="{% static 'classifier/js/filevalidation.js' %}"></script>
        <script type="text/javascript" src="{% static 'classifier/js/fileclassification.js' %}"></script>
        <script type="text/javascript" src="{% static 'classifier/js/downloads.js' %}"></script>
        
        <header>
            <!-- Navigation Bar -->
            <div id="nav-bar" class="z-depth-2">

                <!-- Logo -->
                <a class="brand-logo" href="https://psbehrend.psu.edu/school-of-engineering/resources-for/business-industry-1/senior-design-projects" target="_blank">
                    <img id="logo" src="{% static 'classifier/img/psu-logo.png' %}" width="128" height="128" alt="PSB School of Engineering - Senior Design" border="0" />
                </a>

                <!-- Title -->
                <a href="/">
                    <h1 id="nav-title">OSTSA</h1>

                    <!-- Subtitle -->
                    <h5>An Open Source Tool<br/>for Security Analytics</h5>
                </a>

            </div>
        </header>
        
        <main>        
            
            <!-- Upload Card -->
            <div id="upload-row" class="row">
                <div id="upload-card" class="col s6 offset-s3">
                    <div class="card">
                        <div class="card-content">

                            <!-- Title -->
                            <span class="card-title">Choose a File</span>

                            <!-- Instructions -->
                            <p>
                                Select a potentially malicious file. We will classify it to see what
                                malware family it most likely belongs to. Currently, only Portable 
                                Executables (.exe or .dll) are accepted.
                            </p><br/>
                            
                            <!-- Disclaimer -->
                            <span id="disclaimer">
                                <strong>Disclaimer</strong><br/>
                                <p id="disclaimer">
                                    This tool is not intended to determine whether or not a file is malicious;
                                    it is only intended to determine what kind of malware family it would belong
                                    to if it is indeed malware. You should use this tool to help narrow down the
                                    potential risk of a suspicious file, but not to definitely determine if the
                                    file is malware. A tool such as
                                    <a href="https://www.virustotal.com/" target="_blank">VirusTotal</a> is better
                                    suited for determining the maliciousness of a file.
                                </p>
                            </span>

                            <!-- File Upload -->
                            <!-- The #file-box is used for visual indication and allowing drag and drop. The #file-input
                                 is a hidden input used for opening a file dialog. These elements rely on the filebox.js
                                 script. -->
                            <input id="file-input" class="hidden-input" type="file" onchange="onFileChanged(event)" />
                            <div id="file-box" class="card waves-effect no-file" onclick="openFileDialog()" ondragover="checkDragData(event)" 
                                 ondragleave="removeFileBoxAcceptance()" ondrop="getDroppedFile(event)">
                                <div class="card-content">
                                    <span class="card-title">No file selected</span>
                                    <p>Click to open a file dialog or drag a file here.</p>                                    
                                </div>
                            </div>
                            
                        </div>
                    </div>
                </div>
                
                <!-- Tool Buttons - Only appear when valid file is selected -->
                <div id="tool-buttons-card" class="col s6 offset-s3">
                    <div class="card">
                        <div class="card-content">

                            <!-- Classify Button -->
                            <span class="tool-button-item">
                                <a id="classify-button" class="tool-button btn-floating btn-large waves-effect" onclick="classifyFile()">
                                    <i class="large material-icons">assessment</i>
                                </a>
                                <h5>Classify File</h5>
                            </span>

                        </div>
                    </div>
                </div>
                
                <!-- Update Log - Only appears when file is being classified -->
                <div id="update-log" class="col s12" />
                
            </div>
            
            <!-- Classification Results - Only appear when the classification is complete. -->
            <div id="results-row" class="row">

                <!-- Class Name and Description -->
                <div id="class-card" class="col s8 offset-s2">
                    <div class="card">
                        <div class="card-content">
                            
                            <span class="card-title">Classification Results</span>

                            <!-- Class Title and Confidence -->
                            <table>
                                <tr>
                                    <td class="label">File:</td>
                                    <td id="file-name"></td>
                                    <td class="label">Class:</td>
                                    <td id="class-name"></td>
                                    <td class="label">Confidence:</td>
                                    <td id="confidence"></td>
                                </tr>
                            </table>

                            <!-- Class Description -->
                            <p id="class-description"></p>
                            <br/>

                            <!-- Class Link -->
                            <div class="card-action">
                                <a id="class-link" target="_blank">More Info</a>
                            </div>

                        </div>
                    </div>
                </div>
                
                <!-- Matched Sample -->
                <div id="matched-sample-card" class="col s8 offset-s2">
                    <div class="card">
                        <div class="card-content">
                            <span class="card-title">Matched Sample</span>
                            
                            <!-- Sample ID and Percent Difference -->
                            <table>
                                <tr>
                                    <td class="label">Sample ID:</td>
                                    <td id="matched-sample"></td>
                                    <td class="label">Percent Difference:</td>
                                    <td id="percent-difference"></td>
                                </tr>
                            </table>
                            
                            <p>
                                The uploaded file most closely resembles this sample in our database. This is evaluated
                                by comparing the extracted features to the features of each of our samples. Samples are
                                rated on the basis of the average percent difference of all of their features.
                            </p>
                            
                        </div>
                    </div>
                </div>
                
                <!-- Assembly View -->
                <div id="asm-view-card" class="col s8 offset-s2">
                    <div class="card">
                        
                        <div class="card-image">
                            <textarea id="asm-view" rows="20" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"></textarea>
                            
                            <!-- Download Button -->
                            <a class="btn-floating btn-large halfway-fab waves-effect waves" onclick="downloadAsmFile()"><i class="large material-icons">get_app</i></a>
                        </div>
                        
                        <div class="card-content">
                            <span class="card-title">Assembly</span>
                            <p>
                                This text represents the assembly code generated from disassembling the executable.
                                This assembly was generated using the <a href="http://www.capstone-engine.org/" target="_blank">Capstone disassembly framework</a>.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Hex View -->
                <div id="hex-view-card" class="col s8 offset-s2">
                    <div class="card">
                        
                        <div class="card-image">
                            <textarea id="hex-view" rows="20" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"></textarea>
                            
                            <!-- Download Button -->
                            <a class="btn-floating btn-large halfway-fab waves-effect waves" onclick="downloadHexFile()"><i class="large material-icons">get_app</i></a>
                        </div>
                        
                        <div class="card-content">
                            <span class="card-title">Hex View</span>
                            <p>
                                This text was generated from the file in order to extract specific features.
                                This text represents the binary content of the file in hexadecimal format.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Image -->
                <div id="image-card" class="col s8 offset-s2">
                    <div class="card">
                        
                        <div class="card-image">
                            
                            <!-- Image -->
                            <img id="image">
                            
                            <!-- Download Button -->
                            <a class="btn-floating btn-large halfway-fab waves-effect waves" onclick="downloadImage()"><i class="large material-icons">get_app</i></a>
                            
                        </div>
                        
                        <div class="card-content">
                            <span class="card-title">Image</span>
                            <p>
                                This image was generated from the file in order to extract specific features.
                                Each pixel in this image represents a single hex digit from the hex view.
                            </p>
                        </div>
                    </div>
                </div>

            </div>
            
        </main>
        
        <footer class="page-footer grey darken-1">            
            <!-- Description -->
            <div class="container">
                <div class="row">
                    <div id="footer-description">
                        <h5>Description</h5>
                        <p>
                            OSTSA is a malware classifier designed by 
                            <a href="http://behrend.psu.edu/" target="_blank">Penn State Behrend</a> students 
                            studying 
                            <a href="http://behrend.psu.edu/school-of-engineering/academic-programs/software-engineering" target="_blank">Software Engineering</a>
                            and 
                            <a href="http://behrend.psu.edu/school-of-engineering/academic-programs/computer-science" target="_blank">Computer Science</a>.
                        </p>
                    </div>
                </div>
            </div>

            <!-- Copyright -->
            <div class="footer-copyright">
                <div class="container">© 2017 OSTSA</div>
            </div>
            
        </footer>
        
    </body>
</html>