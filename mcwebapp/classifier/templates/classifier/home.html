<!DOCTYPE html>
<html>
    <head>
        {% load static %}
        
        <!-- Materialize Stylesheet -->
        <link href="{% static 'classifier/materialize/css/materialize.min.css' %}" rel="stylesheet" />
        
        <!-- Material Icons -->
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
        
        <!-- Page Stylesheet -->
        <link href="{% static 'classifier/css/home.css' %}" rel="stylesheet" />
        
    </head>
    
    <body>
        
        <!-- jQuery and jQuery UI -->
        <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
        
        <!-- Bez (Used for custom Cubic Bezier Easing Function) -->
        <script type="text/javascript" src="{% static 'classifier/bez/bez.min.js' %}"></script>

        <!-- Materialize -->
        <script type="text/javascript" src="{% static 'classifier/materialize/js/materialize.min.js' %}"></script>

        <!-- Page Scripts -->
        <script type="text/javascript" src="{% static 'classifier/js/uifunctions.js' %}"></script>
        <script type="text/javascript" src="{% static 'classifier/js/filebox.js' %}"></script>
        <script type="text/javascript" src="{% static 'classifier/js/filevalidation.js' %}"></script>
        <script type="text/javascript" src="{% static 'classifier/js/fileclassification.js' %}"></script>
        
        <header>
            <!-- Navigation Bar -->
            <div id="nav-bar" class="z-depth-2">

                <!-- Logo -->
                <a class="brand-logo" href="https://psbehrend.psu.edu/school-of-engineering/resources-for/business-industry-1/senior-design-projects">
                    <img id="logo" src="{% static 'classifier/img/psu-logo.png' %}" width="128" height="128" alt="PSB School of Engineering - Senior Design" border="0" />
                </a>

                <!-- Title -->
                <h1 id="nav-title">OSTSA</h1>

                <!-- Subtitle -->
                <h5>An Open Source Tool for Security Analytics</h5>

            </div>
        </header>
        
        <main>        
            
            <!-- Upload Card -->
            <div id="upload-row" class="row">
                <div id="upload-card" class="col s6 offset-s3">
                    <div class="card">
                        <div class="card-content">

                            <!-- Title -->
                            <span class="card-title">Choose a File</span>

                            <!-- Instructions -->
                            <p>Select a malicious file to classify.</p>

                            <!-- File Upload -->
                            <!-- The #file-box is used for visual indication and allowing drag and drop. The #file-input
                                 is a hidden input used for opening a file dialog. These elements rely on the filebox.js
                                 script. -->
                            <input id="file-input" class="hidden-input" type="file" onchange="onFileChanged(event)" />
                            <div id="file-box" class="card waves-effect no-file" onclick="openFileDialog()" ondragover="checkDragData(event)" 
                                 ondragleave="removeFileBoxAcceptance()" ondrop="getDroppedFile(event)">
                                <div class="card-content">
                                    <span class="card-title">No file selected</span>
                                    <p>Click to open a file dialog or drag a file here.</p>                                    
                                </div>
                            </div>
                            
                        </div>
                    </div>
                </div>
                
                <!-- Tool Buttons - Only appear when valid file is selected -->
                <div id="tool-buttons-card" class="col s6 offset-s3">
                    <div class="card">
                        <div class="card-content">

                            <!-- Classify Button -->
                            <span class="tool-button-item">
                                <a id="classify-button" class="tool-button btn-floating btn-large waves-effect" onclick="classifyFile()">
                                    <i class="large material-icons">assessment</i>
                                </a>
                                <h5>Classify File</h5>
                            </span>

                        </div>
                    </div>
                </div>
                
                <!-- Update Log - Only appears when file is being classified -->
                <div id="update-log" class="col s12" />
                
            </div>
            
            <!-- Classification Results - Only appear when the classification is complete. -->
            <div id="results-row" class="row">

                <!-- Class Name and Description -->
                <div id="class-card" class="col s8 offset-s2">
                    <div class="card">
                        <div class="card-content">
                            
                            <span class="card-title">Classification Results</span>

                            <!-- Class Title and Confidence -->
                            <table>
                                <tr>
                                    <td class="label">Class:</td>
                                    <td id="class-name"></td>
                                    <td class="label">Confidence:</td>
                                    <td id="confidence"></td>
                                </tr>
                            </table>

                            <!-- Class Description -->
                            <p id="class-description"></p>

                            <!-- Class Link -->
                            <div class="card-action">
                                <a id="class-link" target="_blank">More Info</a>
                            </div>

                        </div>
                    </div>
                </div>
                
                <!-- Assembly View -->
                <div id="asm-view-card" class="col s8 offset-s2">
                    <div class="card">
                        <div class="card-content">
                            <span class="card-title">Assembly</span>
                            <textarea id="asm-view" rows="20" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"></textarea>
                            <p>
                                This text represents the assembly code generated from disassembling the executable.
                                This assembly was generated using the <a href="http://www.capstone-engine.org/" target="_blank">Capstone disassembly framework</a>.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Hex View -->
                <div id="hex-view-card" class="col s8 offset-s2">
                    <div class="card">
                        <div class="card-content">
                            <span class="card-title">Hex View</span>
                            <textarea id="hex-view" rows="20" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"></textarea>
                            <p>
                                This text was generated from the file in order to extract specific features.
                                This text represents the binary content of the file in hexadecimal format.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Image -->
                <div id="image-card" class="col s8 offset-s2">
                    <div class="card">
                        <div class="card-content">
                            <span class="card-title">Image</span>
                            <div id="image-container"><img id="image"></img></div>
                            <p>
                                This image was generated from the file in order to extract specific features.
                                Each pixel in this image represents a single hex digit from the hex view.
                            </p>
                        </div>
                    </div>
                </div>

            </div>
            
        </main>
        
        <footer>            
            <!-- Description -->
            <div class="row">
                <div class="col s10 offset-s1">
                    <h5>Description</h5>
                    <p>
                        OSTSA is a malware classifier designed by Penn State Behrend students studying Software Engineering and Computer Science.
                    </p>
                </div>
            </div>                
            
            <!-- Copyright -->
            <div class="footer-copyright">
                    
            </div>
        </footer>
        
        
    </body>
</html>